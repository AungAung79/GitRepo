library(Storm)

storm = Storm$new();

storm$lambda = function(s) {
  t = s$tuple;
  s$ack(t);
  s$log(c("processing tuple=",t$id));
  words = strsplit(t$input[0]," ");
  for(word in words){
    print(word);
    storm$emit(word);
  }
};

storm$run();
